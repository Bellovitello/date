function date_field_formatter_view(a,b,c,d,e,f,g){try{var h={},i=g.type;if("date_default"==i){var j=null;if(drupalgap.date_formats[g.settings.format_type]){var k=drupalgap.date_formats[g.settings.format_type];$.each(k,function(a,b){return k=b,!1}),j=k.format}else j=drupalgap.date_types[g.settings.format_type].format;j=date_format_cleanse(j,d.settings.granularity),$.each(f,function(a,b){var c="undefined"!=typeof b.value2,d=c?"From: ":"",e=date_prepare(b.value);if(h[a]={markup:'<div class="value">'+d+date(j,e.getTime())+"</div>"},c){var f=date_prepare(b.value2);h[a].markup+='<div class="value2">To: '+date(j,f.getTime())+"</div>"}})}else if("format_interval"==i){var l=g.settings.interval,m=g.settings.interval_display,n=new Date;$.each(f,function(a,b){var c=date_prepare(b.value);if("time ago"==m||"raw time ago"==m){var d=drupalgap_format_interval((n.getTime()-c.getTime())/1e3,l);"time ago"==m&&(d+=" "+t("ago")),h[a]={markup:d}}else console.log("WARNING: date_field_formatter_view - unsupported interval_display ("+m+")")})}else console.log("WARNING: date_field_formatter_view - unsupported type ("+i+")");return h}catch(o){console.log("date_field_formatter_view - "+o)}}function date_field_widget_form(a,b,c,d,e,f,g,h){try{f[g].type="hidden";var i=c.settings.todate,j=parseInt(d.widget.settings.increment),k=new Date;k.setMinutes(_date_minute_increment_adjust(j,k.getMinutes()));var l=!0,m=!0;if("undefined"!=typeof f[g].value&&""!=f[g].value||(l=!1),"undefined"!=typeof f[g].item&&"undefined"!=typeof f[g].item.value2&&""!=f[g].item.value2||(m=!1),l||""!=f[g].default_value||""==d.settings.default_value||(f[g].default_value=d.settings.default_value),m||(f[g].default_value2=d.settings.default_value2),!l&&""!=f[g].default_value)switch(f[g].default_value){case"now":var n=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(k));f[g].value=n,f[g].default_value=n;break;case"blank":f[g].value="",f[g].default_value="";break;default:console.log("WARNING: date_field_widget_form() - unsupported default value: "+f[g].default_value)}if(!m&&""!=f[g].default_value2)switch(f[g].default_value2){case"same":var n=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(k));f[g].value2=n,f[g].default_value2=n,empty(f[g].value)||(f[g].value+="|"),f[g].value+=f[g].value2,empty(f[g].default_value)||(f[g].default_value+="|"),f[g].default_value+=f[g].default_value2;break;case"blank":f[g].value2="",f[g].default_value2="";break;default:console.log("WARNING: date_field_widget_form() - unsupported default value 2: "+f[g].default_value2)}m&&-1==f[g].value.indexOf("|")&&(f[g].value+="|"+f[g].item.value2,f[g].attributes||(f[g].attributes={}),f[g].attributes.value=f[g].value),(l||m)&&empty(f[g].default_value)&&!empty(f[g].value)&&(f[g].default_value=f[g].value);var o=new Date,p=["value"];empty(i)||p.push("value2"),$.each(p,function(a,b){var e=null;if(l&&"value"==b)if(-1!=f[g].value.indexOf("|")){var h=f[g].value.split("|");e=new Date(h[0])}else e=new Date(f[g].value);m&&"value2"==b&&(e=new Date(f[g].item.value2));var k=date_military(d),n=null,p=null,q=null,r=null,s=null,u=null,v=null;if($.each(c.settings.granularity,function(a,c){if(c){var h=f[g].id;"value2"==b&&(h+="2"),h+="-"+a;var i={id:h,onchange:"date_select_onchange(this, '"+f[g].id+"', '"+a+"', "+k+", "+j+")"};switch(a){case"year":var u=parseInt(o.getFullYear()),w=d.widget.settings.year_range,x=w.split(":"),y=x[0],z=!0;-1==y.indexOf("-")&&-1==y.indexOf("+")||(z=!1),z?y=parseInt(y):(-1!=y.indexOf("+")&&(y=y.replace("+","")),y=parseInt(y)+u),y||(y=u);var A=x[1],B=!0;-1==A.indexOf("-")&&-1==A.indexOf("+")||(B=!1),B?A=parseInt(A):(-1!=A.indexOf("+")&&(A=A.replace("+","")),A=parseInt(A)+u),A||(A=u);for(var C={},D=y;A>=D;D++)C[D]=D;l&&(u=parseInt(e.getFullYear())),n={prefix:theme("date_label",{title:t("Year")}),type:"date_select",value:u,attributes:i,options:C};break;case"month":for(var E=parseInt(o.getMonth())+1,C={},D=1;12>=D;D++)C[D]=""+D;l&&(E=parseInt(e.getMonth())+1),p={prefix:theme("date_label",{title:t("Month")}),type:"date_select",value:E,attributes:i,options:C};break;case"day":for(var F=parseInt(o.getDate()),C={},D=1;31>=D;D++)C[D]=""+D;l&&(F=parseInt(e.getDate())),q={prefix:theme("date_label",{title:t("Day")}),type:"date_select",value:F,attributes:i,options:C};break;case"hour":for(var G=parseInt(o.getHours()),C={},H=k?23:12,I=k?0:1,D=I;H>=D;D++)C[D]=""+D;l&&(G=parseInt(e.getHours()),k||(G>12?G-=12:0===G&&(G=12))),r={prefix:theme("date_label",{title:t("Hour")}),type:"date_select",value:G,attributes:i,options:C},k||(v={type:"select",attributes:{id:i.id.replace(a,"ampm"),onclick:i.onchange.replace(a,"ampm")},value:parseInt(e.getHours())<12?"am":"pm",options:{am:"am",pm:"pm"}});break;case"minute":for(var J=parseInt(o.getMinutes()),C={},D=0;59>=D;D+=j){var K=""+D;1==K.length&&(K="0"+K),C[D]=K}l&&"value"==b?J=parseInt(e.getMinutes()):m&&"value2"==b&&(J=parseInt(e.getMinutes())),1!=j&&(J=_date_minute_increment_adjust(j,J)),s={prefix:theme("date_label",{title:t("Minute")}),type:"date_select",value:J,attributes:i,options:C};break;default:console.log("WARNING: date_field_widget_form() - unsupported grain! ("+a+")")}}}),!empty(i)){var w="value2"!=b?t("From"):t("To");f[g].children.push({markup:theme("header",{text:w+": "})})}var x=null;if(p&&!q?x="ui-grid-a":p&&q&&(x="ui-grid-b"),x&&f[g].children.push({markup:'<div class="'+x+'">'}),n&&(x&&(n.prefix='<div class="ui-block-a">'+n.prefix,n.suffix="</div>"),f[g].children.push(n)),p&&(x&&(p.prefix='<div class="ui-block-b">'+p.prefix,p.suffix="</div>"),f[g].children.push(p)),q){if(x){var y=p?"ui-block-c":"ui-block-b";q.prefix='<div class="'+y+'">'+q.prefix,q.suffix="</div>"}f[g].children.push(q)}x&&f[g].children.push({markup:"</div>"});var z=null;if(r&&s&&!u?z="ui-grid-a":s&&u&&(z="ui-grid-b"),z&&f[g].children.push({markup:'<div class="'+z+'">'}),r&&(z&&(r.prefix='<div class="ui-block-a">'+r.prefix,r.suffix="</div>"),f[g].children.push(r)),s){if(z){var y="ui-block-a";r&&(y="ui-block-b"),s.prefix='<div class="'+y+'">'+s.prefix,s.suffix="</div>"}f[g].children.push(s)}u&&f[g].children.push(u),v&&f[g].children.push(v),x&&f[g].children.push({markup:"</div>"})})}catch(q){console.log("date_field_widget_form - "+q)}}function date_prepare(a){try{return new Date(Date.parse(a.replace(/-/g,"/")))}catch(b){console.log("date_prepare() - "+b)}}function date_military(a){var b=!0;return!a.widget.settings.input_format||-1==a.widget.settings.input_format.indexOf("g")&&-1==a.widget.settings.input_format.indexOf("h")||(b=!1),b}function date_select_onchange(a,b,c,d,e){try{var f=-1!=$(a).attr("id").indexOf("value2"),g=$("#"+b).val(),h=-1!=g.indexOf("|"),i=[];h?i=g.split("|"):i.push(g);var j=null;g?(!f&&empty(i[0])&&(i[0]=date_yyyy_mm_dd_hh_mm_ss()),"undefined"!=typeof device&&"iOS"==device.platform&&(f?h&&(i[1]=i[1].replace(" ","T")):i[0]=i[0].replace(" ","T")),j=f?h?new Date(i[1]):new Date:new Date(i[0])):j=new Date;var k=$(a).val();switch(c){case"year":j.setYear(k);break;case"month":j.setMonth(k-1);break;case"day":j.setDate(k);break;case"hour":if(d)j.setHours(k);else{k=parseInt(k);var l=$("#"+$(a).attr("id").replace(c,"ampm")),m=$(l).val();switch(m){case"am":12==k&&(k=0),j.setHours(k);break;case"pm":12==k&&(k=0),j.setHours(k+12)}}break;case"minute":j.setMinutes(k);break;case"ampm":"pm"==k?j.getHours()<12?j.setHours(j.getHours()+12):j.setHours(j.getHours()):"am"==k&&j.setHours(j.getHours()-12)}j.setMinutes(_date_minute_increment_adjust(e,j.getMinutes()));var n=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(j));f?i[1]=n:i[0]=n,$("#"+b).val(i.join("|"))}catch(o){drupalgap_error(o)}}function _date_minute_increment_adjust(a,b){try{switch(a){case 5:5>b?b=0:10>b?b=5:15>b?b=10:20>b?b=15:25>b?b=20:30>b?b=25:35>b?b=30:40>b?b=35:45>b?b=40:50>b?b=45:55>b?b=50:60>b&&(b=55);break;case 10:10>b?b=0:20>b?b=10:30>b?b=20:40>b?b=30:50>b?b=40:60>b&&(b=50);break;case 15:15>b?b=0:30>b?b=15:45>b?b=30:60>b&&(b=45);break;case 30:30>b?b=0:60>b&&(b=30)}return b}catch(c){console.log("_date_minute_increment_adjust - "+c)}}function date_format_cleanse(a,b){for(grain in b)if(b.hasOwnProperty(grain)){var c=b[grain];if(!c){var d=[];switch(grain){case"year":d=["L","o","Y","y"];break;case"month":d=["F","m","M","n","t"];break;case"day":d=["d","D","j","l","L","N","S","w","z"];break;case"hour":d=[" - ","g:","G:","h:","H:","g","G","h","H"];break;case"minute":d=["i:","i"];break;case"second":d=["s"]}if(d.length)for(var e=0;e<d.length;e++){var f=d[e];a=a.replace(f,"")}}}return a}function date_assemble_form_state_into_field(a,b,c,d,e,f,g,h){try{h.use_delta=!1;var i=d.settings.todate;"undefined"!=typeof device&&"iOS"==device.platform&&(c=c.replace(/ /g,"T"));var j={},k=["value"];return empty(i)||k.push("value2"),$.each(k,function(a,b){j[b]={};var f=-1!=c.indexOf("|"),g=[];f?g=c.split("|"):g.push(c),$.each(d.settings.granularity,function(a,c){var d=null;if("value"==b?d=new Date(g[0]):"value2"==b&&(d=new Date(g[1])),c)switch(a){case"year":j[b].year=d.getFullYear();break;case"month":j[b].month=parseInt(d.getMonth())+1;break;case"day":j[b].day=parseInt(d.getDate());break;case"hour":j[b].hour=parseInt(d.getHours()),date_military(e)||j[b].hour>=12&&(j[b].hour=j[b].hour%12,j[b].ampm="pm");break;case"minute":j[b].minute=""+parseInt(d.getMinutes()),1==j[b].minute.length&&(j[b].minute="0"+j[b].minute)}})}),j}catch(l){console.log("date_assemble_form_state_into_field - "+l)}}function theme_datetime(a){try{var b="";a.attributes.type="hidden",b+="<input "+drupalgap_attributes(a.attributes)+"/>";var c=a.field_info_instance.widget.type,d="theme_"+c;if(drupalgap_function_exists(d)){var e=window[d];b+=e.call(null,a)}else{var f="WARNING: theme_datetime() - unsupported widget type! ("+c+")";console.log(f)}return b}catch(g){console.log("theme_datetime - "+g)}}function theme_date_select(a){try{return theme("select",a)}catch(b){console.log("theme_date_select - "+b)}}function theme_date_label(a){try{return"<div "+drupalgap_attributes(a.attributes)+"><strong>"+a.title+"</strong></div>"}catch(b){console.log("theme_date_label - "+b)}}