function date_field_formatter_view(a,b,c,d,e,f,g){try{var h={},i=g.type;if("date_default"==i){var j=null;if(drupalgap.date_formats[g.settings.format_type]){var k=drupalgap.date_formats[g.settings.format_type];$.each(k,function(a,b){return k=b,!1}),j=k.format}else j=drupalgap.date_types[g.settings.format_type].format;j=date_format_cleanse(j,d.settings.granularity),$.each(f,function(a,b){var c="undefined"!=typeof b.value2,d=c?"From: ":"",e=date_prepare(b.value);if(h[a]={markup:'<div class="value">'+d+date(j,e.getTime())+"</div>"},c){var f=date_prepare(b.value2);h[a].markup+='<div class="value2">To: '+date(j,f.getTime())+"</div>"}})}else if("format_interval"==i){var l=g.settings.interval,m=g.settings.interval_display,n=new Date;$.each(f,function(a,b){var c=date_prepare(b.value);if("time ago"==m||"raw time ago"==m){var d=drupalgap_format_interval((n.getTime()-c.getTime())/1e3,l);"time ago"==m&&(d+=" ago"),h[a]={markup:d}}else console.log("WARNING: date_field_formatter_view - unsupported interval_display ("+m+")")})}else console.log("WARNING: date_field_formatter_view - unsupported type ("+i+")");return h}catch(o){console.log("date_field_formatter_view - "+o)}}function date_field_widget_form(a,b,c,d,e,f,g,h){try{f[g].type="hidden";var i=c.settings.todate,j=parseInt(d.widget.settings.increment),k=new Date;k.setMinutes(_date_minute_increment_adjust(j,k.getMinutes()));var l=!0,m=!0;if("undefined"!=typeof f[g].value&&""!=f[g].value||(l=!1),"undefined"!=typeof f[g].item&&"undefined"!=typeof f[g].item.value2&&""!=f[g].item.value2||(m=!1),l||""!=f[g].default_value||""==d.settings.default_value||(f[g].default_value=d.settings.default_value),m||(f[g].default_value2=d.settings.default_value2),!l&&""!=f[g].default_value)switch(f[g].default_value){case"now":var n=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(k));f[g].value=n,f[g].default_value=n;break;case"blank":f[g].value="",f[g].default_value="";break;default:console.log("WARNING: date_field_widget_form() - unsupported default value: "+f[g].default_value)}if(!m&&""!=f[g].default_value2)switch(f[g].default_value2){case"same":var n=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(k));f[g].value2=n,f[g].default_value2=n,empty(f[g].value)||(f[g].value+="|"),f[g].value+=f[g].value2,empty(f[g].default_value)||(f[g].default_value+="|"),f[g].default_value+=f[g].default_value2;break;case"blank":f[g].value2="",f[g].default_value2="";break;default:console.log("WARNING: date_field_widget_form() - unsupported default value 2: "+f[g].default_value2)}var o=new Date,p=["value"];empty(i)||p.push("value2"),$.each(p,function(a,b){var e=null;if(l&&"value"==b)if(-1!=f[g].value.indexOf("|")){var h=f[g].value.split("|");e=new Date(h[0])}else e=new Date(f[g].value);m&&"value2"==b&&(e=new Date(f[g].item.value2));var k=date_military(d),n=null,p=null,q=null,r=null,s=null,t=null,u=null;if($.each(c.settings.granularity,function(a,c){if(c){var h=f[g].id;"value2"==b&&(h+="2"),h+="-"+a;var i={id:h,onchange:"date_select_onchange(this, '"+f[g].id+"', '"+a+"', "+k+", "+j+")"};switch(a){case"year":var t=parseInt(o.getFullYear()),v=d.widget.settings.year_range,w=v.split(":"),x=w[0],y=!0;-1==x.indexOf("-")&&-1==x.indexOf("+")||(y=!1),y?x=parseInt(x):(-1!=x.indexOf("+")&&(x=x.replace("+","")),x=parseInt(x)+t),x||(x=t);var z=w[1],A=!0;-1==z.indexOf("-")&&-1==z.indexOf("+")||(A=!1),A?z=parseInt(z):(-1!=z.indexOf("+")&&(z=z.replace("+","")),z=parseInt(z)+t),z||(z=t);for(var B={},C=x;z>=C;C++)B[C]=C;l&&(t=parseInt(e.getFullYear())),n={prefix:theme("date_label",{title:"Year"}),type:"date_select",value:t,attributes:i,options:B};break;case"month":for(var D=parseInt(o.getMonth())+1,B={},C=1;12>=C;C++)B[C]=""+C;l&&(D=parseInt(e.getMonth())+1),p={prefix:theme("date_label",{title:"Month"}),type:"date_select",value:D,attributes:i,options:B};break;case"day":for(var E=parseInt(o.getDate()),B={},C=1;31>=C;C++)B[C]=""+C;l&&(E=parseInt(e.getDate())),q={prefix:theme("date_label",{title:"Day"}),type:"date_select",value:E,attributes:i,options:B};break;case"hour":for(var F=parseInt(o.getHours()),B={},G=k?23:12,H=k?0:1,C=H;G>=C;C++)B[C]=""+C;l&&(F=parseInt(e.getHours())),r={prefix:theme("date_label",{title:"Hour"}),type:"date_select",value:F,attributes:i,options:B},k||(u={type:"select",attributes:{id:i.id.replace(a,"ampm"),onclick:i.onchange.replace(a,"ampm")},options:{am:"am",pm:"pm"}});break;case"minute":for(var I=parseInt(o.getMinutes()),B={},C=0;59>=C;C+=j){var J=""+C;1==J.length&&(J="0"+J),B[C]=J}l&&"value"==b?I=parseInt(e.getMinutes()):m&&"value2"==b&&(I=parseInt(e.getMinutes())),1!=j&&(I=_date_minute_increment_adjust(j,I)),s={prefix:theme("date_label",{title:"Minute"}),type:"date_select",value:I,attributes:i,options:B};break;default:console.log("WARNING: date_field_widget_form() - unsupported grain! ("+a+")")}}}),!empty(i)){var v="value2"!=b?"From":"To";f[g].children.push({markup:theme("header",{text:v+": "})})}var w=null;if(p&&!q?w="ui-grid-a":p&&q&&(w="ui-grid-b"),w&&f[g].children.push({markup:'<div class="'+w+'">'}),n&&(w&&(n.prefix='<div class="ui-block-a">'+n.prefix,n.suffix="</div>"),f[g].children.push(n)),p&&(w&&(p.prefix='<div class="ui-block-b">'+p.prefix,p.suffix="</div>"),f[g].children.push(p)),q){if(w){var x=p?"ui-block-c":"ui-block-b";q.prefix='<div class="'+x+'">'+q.prefix,q.suffix="</div>"}f[g].children.push(q)}w&&f[g].children.push({markup:"</div>"});var y=null;if(r&&s&&!t?y="ui-grid-a":s&&t&&(y="ui-grid-b"),y&&f[g].children.push({markup:'<div class="'+y+'">'}),r&&(y&&(r.prefix='<div class="ui-block-a">'+r.prefix,r.suffix="</div>"),f[g].children.push(r)),s){if(y){var x="ui-block-a";r&&(x="ui-block-b"),s.prefix='<div class="'+x+'">'+s.prefix,s.suffix="</div>"}f[g].children.push(s)}t&&f[g].children.push(t),u&&f[g].children.push(u),w&&f[g].children.push({markup:"</div>"})})}catch(q){console.log("date_field_widget_form - "+q)}}function date_prepare(a){try{return new Date(Date.parse(a.replace(/-/g,"/")))}catch(b){console.log("date_prepare() - "+b)}}function date_military(a){var b=!0;return!a.widget.settings.input_format||-1==a.widget.settings.input_format.indexOf("g")&&-1==a.widget.settings.input_format.indexOf("h")||(b=!1),b}function date_select_onchange(a,b,c,d,e){try{var f=-1!=$(a).attr("id").indexOf("value2"),g=$("#"+b).val(),h=-1!=g.indexOf("|"),i=[];h?i=g.split("|"):i.push(g);var j=null;g?(!f&&empty(i[0])&&(i[0]=date_yyyy_mm_dd_hh_mm_ss()),"undefined"!=typeof device&&"iOS"==device.platform&&(f?h&&(i[1]=i[1].replace(" ","T")):i[0]=i[0].replace(" ","T")),j=f?h?new Date(i[1]):new Date:new Date(i[0])):j=new Date;var k=$(a).val();switch(c){case"year":j.setYear(k);break;case"month":j.setMonth(k-1);break;case"day":j.setDate(k);break;case"hour":if(d)j.setHours(k);else{k=parseInt(k);var l=$("#"+$(a).attr("id").replace(c,"ampm")),m=$(l).val();switch(m){case"am":12==k&&(k=0),j.setHours(k);break;case"pm":12==k&&(k=0),j.setHours(k+12)}}break;case"minute":j.setMinutes(k);break;case"ampm":"pm"==k?j.getHours()<12?j.setHours(j.getHours()+12):j.setHours(j.getHours()):"am"==k&&j.setHours(j.getHours()-12)}j.setMinutes(_date_minute_increment_adjust(e,j.getMinutes()));var n=date_yyyy_mm_dd_hh_mm_ss(date_yyyy_mm_dd_hh_mm_ss_parts(j));f?i[1]=n:i[0]=n,$("#"+b).val(i.join("|"))}catch(o){drupalgap_error(o)}}function _date_minute_increment_adjust(a,b){try{switch(a){case 5:5>b?b=0:10>b?b=5:15>b?b=10:20>b?b=15:25>b?b=20:30>b?b=25:35>b?b=30:40>b?b=35:45>b?b=40:50>b?b=45:55>b?b=50:60>b&&(b=55);break;case 10:10>b?b=0:20>b?b=10:30>b?b=20:40>b?b=30:50>b?b=40:60>b&&(b=50);break;case 15:15>b?b=0:30>b?b=15:45>b?b=30:60>b&&(b=45);break;case 30:30>b?b=0:60>b&&(b=30)}return b}catch(c){console.log("_date_minute_increment_adjust - "+c)}}function date_format_cleanse(a,b){for(grain in b)if(b.hasOwnProperty(grain)){var c=b[grain];if(!c){var d=[];switch(grain){case"year":d=["L","o","Y","y"];break;case"month":d=["F","m","M","n","t"];break;case"day":d=["d","D","j","l","L","N","S","w","z"];break;case"hour":d=[" - ","g:","G:","h:","H:","g","G","h","H"];break;case"minute":d=["i:","i"];break;case"second":d=["s"]}if(d.length)for(var e=0;e<d.length;e++){var f=d[e];a=a.replace(f,"")}}}return a}function date_assemble_form_state_into_field(a,b,c,d,e,f,g,h){try{h.use_delta=!1;var i=d.settings.todate;"undefined"!=typeof device&&"iOS"==device.platform&&(c=c.replace(/ /g,"T"));var j={},k=["value"];return empty(i)||k.push("value2"),$.each(k,function(a,b){j[b]={};var e=-1!=c.indexOf("|"),f=[];e?f=c.split("|"):f.push(c),$.each(d.settings.granularity,function(a,c){var d=null;if("value"==b?d=new Date(f[0]):"value2"==b&&(d=new Date(f[1])),c)switch(a){case"year":j[b].year=d.getFullYear();break;case"month":j[b].month=parseInt(d.getMonth())+1;break;case"day":j[b].day=parseInt(d.getDate());break;case"hour":j[b].hour=parseInt(d.getHours());break;case"minute":j[b].minute=""+parseInt(d.getMinutes()),1==j[b].minute.length&&(j[b].minute="0"+j[b].minute)}})}),j}catch(l){console.log("date_assemble_form_state_into_field - "+l)}}function theme_datetime(a){try{var b="";a.attributes.type="hidden",b+="<input "+drupalgap_attributes(a.attributes)+"/>";var c=a.field_info_instance.widget.type,d="theme_"+c;if(drupalgap_function_exists(d)){var e=window[d];b+=e.call(null,a)}else console.log("WARNING: theme_datetime() - unsupported widget type! ("+c+")");return b}catch(f){drupalgap_error(f)}}function theme_date_select(a){try{return theme("select",a)}catch(b){drupalgap_error(b)}}function theme_date_label(a){try{return"<div "+drupalgap_attributes(a.attributes)+"><strong>"+a.title+"</strong></div>"}catch(b){console.log("theme_date_label - "+b)}}